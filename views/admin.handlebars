{{> navbar}}
<section class="hero is-warning has-text-centered is-fullwidth">
    <div class="hero-body">
        <div class="container">
            <h1 class="title">
                Code Crushers: Admin View
            </h1>
        </div>
    </div>
</section>
<div class="container" id="adminWindow">
    <div class="columns is-mobile" id="content">
        <div class="column is-narrow">
            <ul>
                {{#each questions}}
                <li>
                    <p>
                        {{this.id}}. {{this.question}}
                <li>A. {{this.optionA}}</li>
                <li>B. {{this.optionB}}</li>
                <li>C. {{this.optionC}}</li>
                <li>D. {{this.optionD}}</li>
                <li>Correct Answer: {{this.answer}}</li>

                <button data-id="{{this.id}}" class="delplan">Delete Question!</button>
                {{!-- <a ><button id="update"
                        class="button is-warning is-large is-rounded updateQuestion">Update Question!</button></a> --}}
                <button data-id="{{this.id}}" value="{{this.id}}"
                    class="button is-warning is-large is-rounded banana">Update
                    Question!</button>
                </p>
                </li>
                {{/each}}
            </ul>
        </div>
        <div class="column">
            <button id="create" class="button is-warning is-large is-rounded">Create Question!</button>


            {{> createQuestion}}
            <hr>
            {{> updateQuestion }}
        </div>
    </div>

</div>
<script>
    $(document).ready(function () {
        $(".delplan").on("click", function () {
            const id = $(this).data("id");
            $.ajax({
                method: "DELETE",
                url: `/api/questions/${id}`
            }).then(response => {
                window.location.reload();
            })
        });
        $("#create").on("click", function () {
            $("#createQuestion").removeClass("is-hidden");
            $("#updateQuestion").addClass("is-hidden");
        });
        $(".banana").on("click", function () {
            const data = $(this).data("id");
            console.log(data);
            alert(data);
            $("#createQuestion").addClass("is-hidden");
            $("#updateQuestion").removeClass("is-hidden");
            $("#updateQuestion").on("submit", function (e) {
                e.preventDefault();
                const id = $(this).data("id");
                const question = $("#question").val();
                const optionA = $("#optionA").val();
                const optionB = $("#optionB").val();
                const optionC = $("#optionC").val();
                const optionD = $("#optionD").val();
                const answer = $("#answer").val();

                $.ajax({
                    method: "PUT",
                    url: `/api/questions/${id}`,
                    data: {
                        question,
                        optionA,
                        optionB,
                        optionC,
                        optionD,
                        answer,
                    },
                }).then((response) => {
                    console.log(response);
                    window.location.replace("/questions");
                });
            });




        });
    });
</script>